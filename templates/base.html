<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>VCESPEDES - Panel</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Favicon pequeño -->
    <link rel="icon" type="image/png"
          href="{{ url_for('static', filename='img/favicon_vcespedes.png') }}">

    <!-- Icono grande para Safari / Favoritos / Pantalla de inicio -->
    <link rel="apple-touch-icon" sizes="180x180"
          href="{{ url_for('static', filename='img/apple-touch-icon.png') }}">

    <!-- Bootstrap 5 CDN -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
    >

    <!-- Estilos propios -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/estilos.css') }}">
</head>

<body class="bg-main">

{% set endpoint = request.endpoint or '' %}

<!-- Navbar superior -->
<nav class="navbar navbar-expand-lg navbar-dark bg-navbar border-bottom border-secondary">
    <div class="container-fluid">

        <!-- Logo -->
        <a class="navbar-brand d-flex align-items-center gap-2" href="{{ url_for('index') }}">
            <img src="{{ url_for('static', filename='img/logo-vcespedes.png') }}"
                 alt="Logo VCESPEDES"
                 style="height: 64px; width: auto; border-radius: 4px; display: block;
                        background: rgba(255, 255, 255, 1); padding: 4px;">
        </a>

        <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarContenido" aria-controls="navbarContenido"
                aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarContenido">

            <!-- Links del menú -->
            <ul class="navbar-nav me-auto mb-2 mb-lg-0">

                <!-- Inicio -->
                <li class="nav-item">
                    <a class="nav-link {% if endpoint == 'index' %}active{% endif %}"
                       href="{{ url_for('index') }}">
                       Inicio
                    </a>
                </li>

                <!-- Tiendas -->
                <li class="nav-item">
                    <a class="nav-link {% if endpoint.startswith('tiendas_') %}active{% endif %}"
                       href="{{ url_for('tiendas_index') }}">
                       Tiendas
                    </a>
                </li>

                <!-- Catálogo -->
                <li class="nav-item">
                    <a class="nav-link {% if endpoint.startswith('catalogo_') %}active{% endif %}"
                       href="{{ url_for('catalogo_index') }}">
                       Catálogo
                    </a>
                </li>

                <!-- Gastos -->
                <li class="nav-item">
                    <a class="nav-link {% if endpoint.startswith('gastos_') %}active{% endif %}"
                       href="{{ url_for('gastos_index') }}">
                       Gastos
                    </a>
                </li>

                <!-- Finanzas -->
                <li class="nav-item">
                    <a class="nav-link {% if endpoint.startswith('finanzas_') %}active{% endif %}"
                       href="{{ url_for('finanzas_index') }}">
                       Finanzas
                    </a>
                </li>

                <!-- Inventario -->
                <li class="nav-item">
                    <a class="nav-link {% if endpoint.startswith('inventario_') %}active{% endif %}"
                       href="{{ url_for('inventario_index') }}">
                       Inventario
                    </a>
                </li>

            </ul>

            <!-- Usuario (login/logout) -->
            <ul class="navbar-nav mb-2 mb-lg-0">

                {% if g.user %}

                    <!-- Nombre del usuario logueado -->
                    <li class="nav-item">
                        <span class="nav-link text-accent">
                            {{ g.user.username }}
                        </span>
                    </li>

                    <!-- Botón salir -->
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('logout') }}">
                            Salir
                        </a>
                    </li>

                {% else %}

                    <!-- Si no está logueado -->
                    <li class="nav-item">
                        <a class="nav-link {% if endpoint == 'login' %}active{% endif %}"
                           href="{{ url_for('login') }}">
                           Iniciar sesión
                        </a>
                    </li>

                {% endif %}

            </ul>

        </div>

    </div>
</nav>

<!-- Contenido principal -->
<main class="container py-4">
    {% block content %}{% endblock %}
</main>

<!-- Footer -->
<footer class="text-center text-muted py-3 small">
    VCESPEDES · Sistema interno de gestión
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>